{% macro render_book(book, footer=None) %}
    <section class="book-container">
        <figure class="book-container-thumbnail">
            <div class="book-container-thumbnail-box">
                <img src="{{ url_for('route_thumbnail', key=book.thumbnail_id) }}"
                     alt="{{ book.title | safe }}"/>
            </div>
        </figure>
        <div class="book-container-title">
            <h3>
                <a href="/book/{{ book.entries[0].id }}" rel="nofollow">
                    {{ book.title | safe }}
                </a>
            </h3>
            {% if book.series %}
                <h4>
                    Series:
                    <a href="{{ url_for('route_index', q=book.series) }}">
                        {{ book.series }}
                    </a>
                </h4>
            {% endif %}
        </div>
        <div class="book-container-main">
            {% if book.tags or book.characters %}
                <div>
                    {% for tag in book.tags %}
                        <div class="tag tag-general">
                            <a href="{{ url_for('route_index', q=("tag:" + tag | encode_query_term)) }}"
                               rel="nofollow">
                                {{ tag }}
                            </a>
                        </div>
                    {% endfor %}
                    {% for character in book.characters %}
                        <div class="tag tag-character">
                            <a href="{{ url_for('route_index', q=("character:" + character | encode_query_term)) }}"
                               rel="nofollow">
                                {{ character }}
                            </a>
                        </div>
                    {% endfor %}
                </div>
            {% endif %}
            {% if book.descriptions %}
                <div style="display: flex; flex-direction: column;">
                    {% for description in book.descriptions %}
                        <details class="description-box">
                            <summary>{{ description.name }}</summary>
                            {{ description.details | safe }}
                        </details>
                    {% endfor %}
                </div>
            {% endif %}
            <div style="display: flex; flex-direction: column; gap: 0.5rem; width: 100%;">
                {% for entry in book.entries %}
                    <div class="entry-box">
                        <div>
                            {% if entry.url %}
                                <a href="{{ entry.url }}" rel="nofollow">
                                    {{ entry.title | safe }}
                                </a>
                            {% else %}
                                {{ entry.title | safe }}
                            {% endif %}
                        </div>
                        <div class="entry-box-attributes">
                            {% if entry.language %}
                                <b>{{ entry.language }}</b>
                            {% else %}
                                <b>Metadata</b>
                            {% endif %} •
                            <b>{{ entry | entry_readable_source }}</b>
                            {% if entry.page_count %}
                                • <b>{{ pluralize(entry.page_count, "page") }}</b>
                            {% endif %}
                            {% if entry.date %}
                                •
                                <time datetime="{{ entry.date }}"
                                      title="{{ entry.date.strftime('%-d %B %Y') }}">
                                    <b>{{ entry.date | age }}</b>
                                </time>
                            {% endif %}
                            {% if entry.comments %}
                                •
                                <b>{{ pluralize(entry.comments, "comment") }}</b>
                            {% endif %}
                        </div>
                    </div>
                {% endfor %}
            </div>
            {% if footer %}
                {{ footer() }}
            {% endif %}
        </div>
    </section>
{% endmacro %}
